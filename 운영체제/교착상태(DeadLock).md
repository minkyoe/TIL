## 교착상태 (DeadLock)

### 교착상태란

- 프로세스가 자원을 얻지 못해서 다음 처리를 하지 못하는 상태
- 한정된 자원을 여러 곳에서 사용하려고 할 때, 발생하는 문제
- 모든 스레드가 Lock이 풀리기를 기다리고 있기 때문에, 무한대기 상태에 빠짐





### 교착상태 조건

> 4가지 조건이 동시에 성립할 때, 발생함
>
> 4가지 조건 중 하나라도 성립하지 않으면 교착 상태 해결 가능

1. 상호배제
   - 한 번에 한 프로세스만 공유 자원을 사용할 수있음
   - 공유 자원에 대한 접근 권한이 제한됨
2. 점유대기
   - 공유 자원에 대한 접근 권한을 갖고 있는 프로세스가, 그 접근 권한을 양보하지 않은 상태에서 다른 자원에 대한 접근 권한을 요구할 수 있음
3. 비선점 (선취 불가능)
   - 한 프로세스가 다른 프로세스의 자원 접근 권한을 강제로 취소할 수 없음
4. 순환대기
   - 두 개 이상의 프로세스가 자원 접근을 기다리는데, 그 관계에 사이클이 존재함



### 교착상태 예방

> 교착 상태 발생 조건 중 하나를 제거함으로써 해결하는 방법
>
> 자원의 낭비가 심하다는 단점

1. 상호 배제 부정
   - 여러 프로세스가 공유 자원을 사용하도록 함
2. 점유 대기 부정
   - 프로세스가 실행되기 전, 필요한 모든 자원을 할당함
3. 비선점 부정
   - 자원 점유 중인 프로세스가 다른 자원을 요구할 때, 점유 중인 자원을 반납하고 요구한 자원을 사용하기 위해 기다리게 함
4. 순환 대기 부정
   - 자원에 고유한 번호를 할당하고, 번호 순서대로 자원을 요구하도록 함





### 교착상태 회피

- 은행원 알고리즘 (Banker's Algorithm)
  - 프로세스가 자원을 요구할 때, 시스템은 자원을 할당한 후에도 안정 상태로 남아있게 되는지 사전에 검사하여 교착상태 회피
  - 안정 상태면 자원 할당, 아니면 다른 프로세스들이 자원 해지까지 대기





### 교착상태 탐지 & 회복

1. 탐지
   - 자원 할당 그래프를 통해 교착 상태를 탐지함 
   - 자원 요청 시, 탐지 알고리즘을 실행시켜 그에 대한 오버헤드가 발생함
2. 회복
   - 교착 상태를 일으킨 프로세스를 종료하거나 할당된 자원을 해제함
   - 프로세스 종료 방법
     - 교착 상태의 프로세스 모두 중지
     - 교착 상태가 제거될 때까지 한 프로세스씩 중지
   - 자원 선점 방법
     - 교착 상태의 프로세스가 점유하고 있는 자원을 선점하여 다른 프로세스에게 할당, 해당 프로세스는 일시 정지시킴
     - 우선순위가 낮은 프로세스, 수행된 횟수가 적은 프로세스 등을 위주로 프로세스의 자원을 선점함













<br/>

<br/>

<br/>

<br/>

> 참고
>
> https://github.com/WooVictory/Ready-For-Tech-Interview/blob/master/Operating%20System/%EA%B5%90%EC%B0%A9%EC%83%81%ED%83%9C(DeadLock).md
>
> https://github.com/WeareSoft/tech-interview/blob/master/contents/os.md#%EA%B5%90%EC%B0%A9%EC%83%81%ED%83%9C%EC%9D%98-%EA%B0%9C%EB%85%90%EA%B3%BC-%EC%A1%B0%EA%B1%B4
>
> https://github.com/gyoogle/tech-interview-for-developer/blob/master/Computer%20Science/Operating%20System/DeadLock.md